{% extends 'base.html' %}

{% block content %}
<div style="text-align: center;">
    <h1 class="main-title">ğŸ“Š DATA OVERVIEW</h1>
</div>

{% if no_data %}
<div class="info-box" style="max-width: 800px; margin: 3rem auto;">
    <h3 style="color: white;">ğŸ‘ˆ Upload Your Solar Data to Get Started</h3>
    <p style="color: white; font-size: 1.1rem;">Use the file uploader in the sidebar to begin analyzing your solar panel performance.</p>
</div>
{% elif error %}
<div class="warning-box" style="max-width: 800px; margin: 3rem auto;">
    <h3>âŒ Error Loading Data</h3>
    <p style="font-size: 1.1rem;">{{ error }}</p>
</div>
{% else %}

<div style="margin-top: 2rem;">
    <h3 class="section-header">ğŸ“‹ Dataset Information</h3>
    
    <div class="blue-card">
        <p style="color: #1e40af; font-size: 1.05rem;">
        <strong>Detected Columns:</strong> {{ detected_columns }}
        </p>
        <p style="color: #1e40af; font-size: 1.05rem; margin-top: 0.5rem;">
        <strong>Date Range:</strong> {{ stats.date_range }}
        </p>
    </div>
</div>

<div style="margin-top: 2rem;">
    <h3 class="section-header">ğŸ“Š Statistical Summary</h3>
    
    <div class="grid-4">
        <div class="metric-card-dark">
            <h4 style="color: white; margin: 0;">Total Data Points</h4>
            <h2 style="color: white; margin: 0.5rem 0;">{{ stats.total_rows|floatformat:0 }}</h2>
            <p style="color: rgba(255,255,255,0.8); margin: 0;">Readings analyzed</p>
        </div>
        
        <div class="metric-card-light">
            <h4 style="color: white; margin: 0;">Mean Power</h4>
            <h2 style="color: white; margin: 0.5rem 0;">{{ stats.mean|floatformat:2 }}</h2>
            <p style="color: rgba(255,255,255,0.8); margin: 0;">kW average</p>
        </div>
        
        <div class="metric-card-yellow">
            <h4 style="color: #1e3a8a; margin: 0;">Peak Power</h4>
            <h2 style="color: #1e3a8a; margin: 0.5rem 0;">{{ stats.max|floatformat:2 }}</h2>
            <p style="color: #1e3a8a; margin: 0;">kW maximum</p>
        </div>
        
        <div class="metric-card-dark">
            <h4 style="color: white; margin: 0;">Std Deviation</h4>
            <h2 style="color: white; margin: 0.5rem 0;">{{ stats.std|floatformat:2 }}</h2>
            <p style="color: rgba(255,255,255,0.8); margin: 0;">kW variability</p>
        </div>
    </div>
    
    <div class="grid-2" style="margin-top: 1rem;">
        <div class="blue-card">
            <h4 style="color: #1e3a8a; margin-top: 0;">ğŸ“ˆ Distribution Metrics</h4>
            <ul style="color: #1e40af; font-size: 1.05rem; line-height: 2;">
                <li><strong>Median:</strong> {{ stats.median|floatformat:2 }} kW</li>
                <li><strong>25th Percentile (Q1):</strong> {{ stats.q25|floatformat:2 }} kW</li>
                <li><strong>75th Percentile (Q3):</strong> {{ stats.q75|floatformat:2 }} kW</li>
                <li><strong>Minimum:</strong> {{ stats.min|floatformat:2 }} kW</li>
            </ul>
        </div>
        
        <div class="yellow-card">
            <h4 style="color: #1e3a8a; margin-top: 0;">ğŸ’¡ Quick Insights</h4>
            <p style="color: #1e40af; font-size: 1.05rem; line-height: 1.7;">
            Your solar system shows {{ stats.total_rows|floatformat:0 }} data points with an average output of {{ stats.mean|floatformat:2 }} kW. 
            Peak performance reached {{ stats.max|floatformat:2 }} kW, demonstrating your system's maximum capacity.
            </p>
        </div>
    </div>
</div>

<div style="margin-top: 2rem;">
    <h3 class="section-header">ğŸ“ˆ Power Output Over Time</h3>
    <div style="background: white; padding: 1.5rem; border-radius: 15px; box-shadow: 0 5px 20px rgba(0,0,0,0.1);">
        {{ chart_html|safe }}
    </div>
</div>

{% if daily_chart_html %}
<div style="margin-top: 2rem;">
    <h3 class="section-header">ğŸ“… Daily Production Trends</h3>
    <div style="background: white; padding: 1.5rem; border-radius: 15px; box-shadow: 0 5px 20px rgba(0,0,0,0.1);">
        {{ daily_chart_html|safe }}
    </div>
</div>
{% endif %}

<div style="margin-top: 2rem;">
    <h3 class="section-header">ğŸ’¡ Key Insights & Recommendations</h3>
    
    <div class="grid-2">
        {% for insight in insights %}
        <div class="{% cycle 'blue-card' 'yellow-card' %}">
            <h3 style="color: #1e3a8a;">{{ insight.title }}</h3>
            <p style="color: #1e40af; font-size: 1.05rem; line-height: 1.7;">{{ insight.message|safe }}</p>
        </div>
        {% endfor %}
    </div>
</div>

{% endif %}
{% endblock %}


